services:

  agent_server:
    profiles:
      - default
      - full
    restart: unless-stopped  
    image: agent_server:1.0
    container_name: agent_server
    hostname: agent_server
    runtime: nvidia
    environment:
      - NVIDIA_VISIBLE_DEVICES=0
      - NVIDIA_DRIVER_CAPABILITIES=compute,utility
      - LD_LIBRARY_PATH=/usr/local/cuda/lib64:/usr/lib/x86_64-linux-gnu
      - CUDA_HOME=/usr/local/cuda    
    logging:
      options:
        max-size: "10m"
        max-file: "3"    
    networks:
      logus2k_network:
    ports:
      - "7701:7701"
    volumes:
      - ~/env/agent_server/data:/agent_server/app/data:ro

networks:
  logus2k_network:
    external: true
